# (Не)очевидные трюки отладки фронтенда
*фото c фронтендером, кидающем девасы / Firefox и Chrome лого / что-нибудь еще*

Так получается, что большую часть времени разработчик тратит на отладку кода.
Поэтому нужно уметь это делать, и делать это хорошо.  
Что бы вы могли сказать про отладку и фронтенд? Конечно же _console.log_, _debugger_ и еще десяток классных штук из DevTools. Теперь вы знаете о чем будет половина этого текста ツ  
А за остальным интригующе приглашаю под кат!

### Дисклеймер
Все будет в коротком виде – описание с применением. Многие трюки весьма просты, но это не является показателем их бесполезности.  
Подрoбности специально убраны под спойлер, чтобы туда смотрели только если этот трюк неизвестен. Надеюсь что доступное описание все же будет полезно.

Приведнные примеры были сделаны в [Chrome Canary](https://www.google.com/chrome/browser/canary.html) и [Firefox Developer Edition](https://www.mozilla.org/en-US/firefox/developer/), поэтому лучше установить эти версии браузеров. Так вы сможете уже сейчас пользоваться тем, что в стабильной версии появится только через 3 месяца.

#### Редактирование кода в браузере
Представим что мы столкнулись с проблемой на лайве и изменять скрипты на сервере мы не имеем возможности. В таком случае мы можем попробовать изменить код до выполнения (и даже во время выполнения) в Chrome.  
Для этого нужно поставить точку останова до интересующего нас кода, внести необходимые изменения, сохранить и продолжить выполнение.

Я сделал демку. Попробуйте ее пройти не заглядывая под кат.

> Подробнее
На даннй момент такое возможно только в Google Chrome. Даже получило свое собственное название "something editing".
Теперь как сделать демо:
1. Находим скрипт и ставим точку останова на строке 22
2. Перезагружаем страницу
3. Открывается отладчик и мы можем редактировать код ниже
4. Вносим изменения и сохраняем (cmd + S)
5. Продолжаем выполнение

Работает очень магически, ни один бразуер кроме Chrome так делать не умеет.
А именно – при изменении весь код в текущем контексте перевыполняется.
Это нужно учитывать, в некоторых случаях функции могут изменять внешнее состояние
и выполняясь повтороно, сделают это два раза.

К сожалению нельзя сохранить наши изменения при перезагрузке.
Для чего-то более сложного лучше использовать прокси.

#### Подмена скриптов через прокси
Здесь все просто – есть скрипты, которые мы хотели бы изменить. Есть много решений,
но мне нравится BrowserSync. Потому что конфигурируем на JavaScript,
используем connect-middlewares, получаем перезагрузку и обновление CSS на лету.
Может быть полезно когда нет доступа на хост, либо делать изменения и синхронизировать получается долго.

> Подробнее
Пример с BrowserSync.

#### Подмена страниц в WebView
Подключаемся к девайсу инспектором и изменяем window.location.href на нужный.
Нужно иметь в виду что отладка возможна только начиная с Android версии 4.4.
*почитать что там обновляется*

Полезно когда нужно сделать изменения, но при этом не хотелось бы пересобирать приложение для другого урла. Про изменения на продакшене я вообще не говорю.

> Подробнее
window.location.href = xxx, и мы видим любую интересующую нас страницу.
Референс на то Как сохранить страницу, как захостить страницу.

#### Отладка с помощью Valence
Valence является адаптером к различным браузерам / девайсам.
Таким образом можно использовать привычный инструмент всегда, либо сделать его привычным ;) А под Windows это единственный способ отлаживать девайсы c iOS.

#### Вылезаем из локальной сети
Мы хотим показать свою работу, но при этом не хотелось бы аплоадить ее куда-нибудь. Либо нам нужно вытащить свой дев-сервер наружу.
Для этого отлично подходит ngrok, либо SSH в случае если у вас есть VPS.

> Подробнее
Наша машинка находится в локальной сети (например локальная сеть на работе) и все те кто находится не на работе, не смогут иметь доступ к нашей машинке. Поэтому мы используем сервер-посредник, который общедоступен. Трафик идет через посредника, соединение установлено.

#### Букмарклет для повторяющихся действий
Заполнение формочек, регистрация аккаунта.
Пример с формочкой.

#### Воспроизводим как тестировщики
Букмарклет для получения всей необходимой информации.
* url
* cookies
* html
* stack traces
*
httponly cookies (нужен плагин)

#### Эмулятор Android девайсов
Genymotion прекрасен!

#### Сохранение страницы
Это все лишь обычный `cmd` + `S`. Но что можно сделать со страницей дальше?
*Chrome не сохраняет скрипты?*
Мы можем залить ее на хостинг, какой-нибудь Dropbox или Github Pages.
Либо выполнить `python -m SimpeHTTServer` и получить локальный сервер раздающий статику. Дальше можно пойти в _Вылезаем из локальной сети_, и вытащить свой локальный сервер наружу.

#### Mixed Type Content
Возникает когда есть http и https. Какой-то из них не загружается.
Это очень частая ошибка, про которую почему-то все забывают. Последний раз был случай, когда только на мобильном приложении на Android 5+ появлялся плейсхолдер заместо ориганального изображения. Тогда еще были проблемы с тем, чтобы это воспроизвести. Но все же, не забывайте о существовании такой ошибки!

#### Приятые мелочи в DevTools
*Демо!*
* Скрытие элемента по хоткею `H`, так же как и скролл по `S`
* Выделение измененных стилей в Firefox
* Переключение классов Chrome
* Редактор анимации
* *Посмотреть Safari и IE, ну и Opera тоже*
* Промисы и async в Chrome

#### Фронтенд и PHP
Написать про watchx. Прокси. Что из этого получилось.
